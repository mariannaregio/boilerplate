var SMI_ProductCard=class t{options={card:".smi-product-card",thumbnail:".smi-product-card__thumbnail",variants:{wrapper:".smi-variants",item:".smi-variants__item"}};constructor(t={}){this.options={...this.options,...t},this.handleVariantClick(),this.handleAddToCart()}handleVariantClick(){let t=document.querySelectorAll(this.options.variants.wrapper),e=this.options.variants.item.replace(".","")+"--active";t.forEach(t=>{let r=t.querySelectorAll(this.options.variants.item);r.forEach(r=>{r.addEventListener("click",i=>{let s=t.querySelector(`${this.options.variants.item}.${e}`);s&&s.classList.remove(e),r.classList.add(e);let a=r.dataset.mediaUrl;if(a){let n=t.closest(this.options.card),o=n.querySelector(`${this.options.thumbnail} img:nth-child(1)`);o&&(o.removeAttribute("srcset"),o.setAttribute("src",a))}let c=r.getAttribute("data-id");if(c){let l=r.closest(".smi-product-card"),d=l.querySelectorAll("a");d.length&&d.forEach(t=>{let e=t.getAttribute("href"),r=e.split("?")[0];t.setAttribute("href",`${r}?variant=${c}`)})}})})})}handleAddToCart(){let t=document.querySelectorAll(".smi-button-cart._cart_now a");t.length&&t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let r=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),i=t.getAttribute("data-id");t.classList.add("smi-cart-adding");let s=t.getAttribute("data-text-add-cart"),a=t.getAttribute("data-text-added"),n=t.getAttribute("data-text-failed"),o=t.querySelector(".smi-cart-text"),c=window.smiObject?window.smiObject.cartType:"page",l=this.getSectionsToRender().map(t=>t.section);r&&(l=[...l,...r.getSectionsToRender().map(t=>t.id)]);let d={quantity:1,id:parseInt(i),sections:l,sections_url:window.location.pathname};fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(t=>t.json()).then(t=>{let e=!1;t?.status==422||t?.message==="Cart Error"?(e=!0,o.innerText=n):o.innerText=a,console.log(t);let i=setTimeout(()=>{o.innerText=s,clearTimeout(i)},2e3);if(!e){let l=this.getSectionsToRender();l.forEach(e=>{let r=document.getElementById(e.id);if(r){let i=r.querySelector(e.selector),s=null;(s=i||r)&&(s.innerHTML=this.getSectionInnerHTML(t.sections[e.section],e.selector),"function"==typeof SMI_CartDrawer&&"drawer"===c?setTimeout(()=>{document.dispatchEvent(new CustomEvent("smiCartDrawerRender"));let t=document.querySelector("#smi-cart-button .smi-cart-badges");if(t){let e=t.innerText;document.dispatchEvent(new CustomEvent("smiCartCounter",{data:e}))}},150):window.location.href=window.smiObject.routes.cart_url)}}),r?"function"==typeof r.renderContents&&r.renderContents(t):"function"!=typeof SMI_CartDrawer&&window.smiObject&&(window.location.href=window.smiObject.routes.cart_url)}}).finally(()=>{t.classList.remove("smi-cart-adding"),r&&r.classList.contains("is-empty")&&r.classList.remove("is-empty")})})})}getSectionsToRender(){let t=document.getElementById("smi-drawer-items"),e=[{id:"smi-cart-button",section:"smi-cart-icon-bubble",selector:".shopify-section"}];return t&&e.push({id:"shopify-section-"+t.dataset.id,section:t.dataset.id,selector:".smi-drawer-items_w"}),e}getSectionInnerHTML(t,e){return new DOMParser().parseFromString(t,"text/html").querySelector(e).innerHTML}};Shopify.designMode?new SMI_ProductCard:window.addEventListener("DOMContentLoaded",t=>{new SMI_ProductCard});